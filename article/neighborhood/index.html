<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Marian Kleineberg">
        <meta name="description" content="Personal blog about programming, game development and space ships.">
        <meta name="keywords" content="">
        <meta name="generator" content="Hugo 0.55.4" />
        <title>
			
				
					3D printed model of my neighborhood |
				
				Marian&#39;s Blog
			
		</title>
        <meta name="description" content="3D printed model of my neighborhood - Personal blog about programming, game development and space ships.">
        <meta itemprop="name" content="3D printed model of my neighborhood">
        <meta itemprop="description" content="3D printed model of my neighborhood - Personal blog about programming, game development and space ships.">
        <meta property="og:title" content="3D printed model of my neighborhood">
        <meta property="og:description" content="3D printed model of my neighborhood - Personal blog about programming, game development and space ships.">
        <meta property="og:image" content="">
        <meta property="og:url" content="https://marian42.de/article/neighborhood/">
        <meta property="og:site_name" content="Marian&#39;s Blog">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://marian42.de/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://marian42.de/favicon-16x16.png" sizes="16x16">

        
        
        
        
        
        
        <link rel="stylesheet" href="https://marian42.de/sass/combined.min.2441e62c6bd67cf08a73659344468d18941f6361820bdffed9b4ce177d6ea5fd.css">

        
    </head>
    <body class="bilberry-hugo-theme">
        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                <img src="/marian.png" alt="">
            </a>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        <article class="default article">
    <div class="content">
    <h1 class="article-headline"><a href="/article/neighborhood/">3D printed model of my neighborhood</a></h1>
    
		<div class="meta">
    		<span class="date">April 17, 2018</span>
		</div>
    

    
        <a href="/article/neighborhood/DSCF3466.jpg" target="_blank" title="">
	<img src="/article/neighborhood/DSCF3466_hu0304cb7e538da5a35ca6f72df4bbc0a9_4451455_1272x0_resize_q75_box.jpg" width="1272" alt="">
</a>



<p>I 3D printed a model of the street where I live. This post will explain how I prepared the data for it.</p>

<p><strong>Update</strong>: I have now automated the entire process and published my code. You can find it <a href="https://github.com/marian42/pointcloudprinter">here</a>.</p>

<p>I worked with aerial Lidar data that is provided by the state I live in to <a href="https://www.opengeodata.nrw.de/produkte/geobasis/dom/dom1l/">download</a> for free. After completing the rather big download, I figured out what my coordinates are in the projection used with the data and which XYZ file they fall into. I wrote a simple program to extract all the points within a 200m square around my house.</p>






<a href="/article/neighborhood/square.png" target="_blank" title="">
	<img src="/article/neighborhood/square_hu54a05c297a7ded348f622a81f63cad57_539415_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p>This left me with a smaller XYZ file, now containing 430k points, which are pictured above. The task now was now to turn all these points into a solid body in order to be printable.</p>

<p>In order to turn the pointcloud into a mesh, I used the software MeshLab. As a first step, I used the program to estimate normals for the pointcloud. The normals are estimated by fitting a plane into some nearby points and using the normal of that plane. However, knowing the plane, there are still two possible normals of which one has to be selected. For some separated parts of the pointcloud, the normals can be flipped and need to be manually fixed.</p>

<p>Here is a mesh that MeshLab generates without normals fixed and wihtout holes patched:</p>






<a href="/article/neighborhood/first.png" target="_blank" title="">
	<img src="/article/neighborhood/first_hua3cc1ad2326f7318912c34595ad41dac_1290287_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p>Since the Lidar data are taken from an airplane, parts of the surface that are occluded from the perspective of the plane result in holes in the pointcloud. After trying to generate a mesh with no success, I had to fix the holes first.</p>






<a href="/article/neighborhood/Screenshot-149.png" target="_blank" title="">
	<img src="/article/neighborhood/Screenshot-149_huec574cf7580820776255c5b16cf7b9eb_1032567_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p>I made a program to detect and fill the holes. First it tries to identify points on the edge of holes. This is done by measuring the distance of a point to the average of some nearby points. This distance is small when the nearby points are found in all directions. Points on an edge have less neighbours towards the hole, resulting in an average shifted away from the edge. Points found like this are shown in red in the above screenshot.</p>

<p>Next, to create patches, the program looks for edge points with other edge points straight above them. Depending on the distance, new points are then created on the connecting line. These are shown in green.</p>






<a href="/article/neighborhood/Screenshot-149b.png" target="_blank" title="">
	<img src="/article/neighborhood/Screenshot-149b_hu072b60a146f2e2602077e94e4921c18e_1568067_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p>Now I can apply what MeshLab calls “Screened Poisson Surface Reconstruction”. With the holes patched, normals corrected and parameters tweaked, I have a mesh of the surface.</p>

<p>This mesh can be opened in Blender. I selected the outer vertices, moved them down and connected them, resulting in this:</p>






<img src="/article/neighborhood/belnder.png" width="1096" alt="">



<p>This is finally a solid body, although an ugly one. I created a 200m cube and applied a Boolean / Intersect operation between the two, resulting in the final model for printing. Here it is being prepared in Cura:</p>






<a href="/article/neighborhood/Screenshot-150.png" target="_blank" title="">
	<img src="/article/neighborhood/Screenshot-150_hu16f154dd47c9881400f973f8f5311294_997269_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p>I printed it 12cm long with the smallest layer size available, 0.06mm, which took 21 hours. </p>






<a href="/article/neighborhood/DSCF3482.jpg" target="_blank" title="">
	<img src="/article/neighborhood/DSCF3482_huffb867a27675b009de6b88a54bf6c5d8_292533_1272x0_resize_q75_box.jpg" width="1272" alt="">
</a>
    
</div>

    
<div class="footer">


	
	    
	        <div class="tags">
				tagged
	            <div class="links">
	                
	                    <a href="/tags/3dprinting">3dprinting</a>
	                
	                    <a href="/tags/graphics">graphics</a>
	                
	                    <a href="/tags/pointcloud">pointcloud</a>
	                
	            </div>
	        </div>
	    
	
</div>

</article>

    </div>
	
     

        </div>

        
<footer>
    <div class="container">
		<div class="left">
			
			
				<a href="mailto:mail@marian42.de">Contact</a>&nbsp;
			
        </div>
        <div class="right">
            
            <div class="external-profiles">
                
                    <a href="https://mastodon.gamedev.place/@marian42" target="_blank" rel="me">
                        <i class="fa">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                
                                <path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/>
                            </svg>
                        </i>
                    </a>
                
                
                    <a href="https://twitter.com/marian42_" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                    <a href="https://github.com/marian42" target="_blank"><i class="fa fa-github"></i></a>
                
				
                    <a href="mailto:mail@marian42.de" target="_blank"><i class="fa fa-envelope"></i></a>
                
				
                    <a href="/index.xml" target="_blank"><i class="fa fa-rss"></i></a>
                
            </div>
            
        </div>
    </div>
</footer>



        
    </body>
</html>
