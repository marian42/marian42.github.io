<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Marian Kleineberg">
        <meta name="description" content="Personal blog about programming, game development and space ships.">
        <meta name="keywords" content="">
        <meta name="generator" content="Hugo 0.55.4" />
        <title>
			
				
					Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App |
				
				Marian&#39;s Blog
			
		</title>
        <meta name="description" content="Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App - Personal blog about programming, game development and space ships.">
        <meta itemprop="name" content="Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App">
        <meta itemprop="description" content="Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App - Personal blog about programming, game development and space ships.">
        <meta property="og:title" content="Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App">
        <meta property="og:description" content="Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App - Personal blog about programming, game development and space ships.">
        <meta property="og:image" content="">
        <meta property="og:url" content="https://marian42.de/article/wetterstation/">
        <meta property="og:site_name" content="Marian&#39;s Blog">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://marian42.de/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://marian42.de/favicon-16x16.png" sizes="16x16">

        
        
        
        
        
        
        <link rel="stylesheet" href="https://marian42.de/sass/combined.min.2441e62c6bd67cf08a73659344468d18941f6361820bdffed9b4ce177d6ea5fd.css">

        
    </head>
    <body class="bilberry-hugo-theme">
        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                <img src="/marian.png" alt="">
            </a>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        <article class="default article">
    <div class="content">
    <h1 class="article-headline"><a href="/article/wetterstation/">Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App</a></h1>
    
		<div class="meta">
    		<span class="date">July 9, 2013</span>
		</div>
    

    
        <a href="/article/wetterstation/DSC_0037-3.jpg" target="_blank" title="">
	<img src="/article/wetterstation/DSC_0037-3_huf6b55f4aa8d2badf513b77a8a1000025_560535_1272x0_resize_q75_box.jpg" width="1272" alt="">
</a>



<p>Die Wetterdaten für die Wetterstation werden von einem Board gesammelt, das ich für einen Schülerwettbewerb (<a href="http://www.intel-leibniz-challenge.de/">ILC</a>) bekommen und zusammengesetzt habe. Auf dem Board rechnet ein <a href="http://www.atmel.com/Images/Atmel-8386-8-and-16-bit-AVR-Microcontroller-ATxmega64A3U-128A3U-192A3U-256A3U_datasheet.pdf" target="_blank">ATxmega128A3U</a>. Temperatur, Luftfeuchte, Luftdruck, Helligkeit, Regenmenge und Windgeschwindigkeit werden bestimmt. Die letzen beiden Werte werden durch <a href="http://de.wikipedia.org/wiki/Regenmesser#Digitale_Niederschlagsmesser" target="_blank">mechanische Aufbauten</a> ermittelt, an denen ein Magnet einen Hallsensor passiert.</p>

<p>Auf dem Breadboard befindet sich ein <a href="http://www.atmel.com/Images/doc8161.pdf" target="_blank">ATmega328p</a>, auf dem Arduino-Code läuft. Das ILC-Board sammelt und sendet die sechs Wetterdaten auf Anfrage an den Arduino. Aus Zeitgründen habe ich dafür ein eigenes Protokoll implementiert, diese Aufgabe könnte eleganter und besser mit I²C o.ä. umgesetzt werden.</p>






<img src="/article/wetterstation/Screenshot_2013-05-28-20-11-15.png" width="768" alt="">



<p>Der Arduino ermittelt über eine angeschlossene <a href="http://de.wikipedia.org/wiki/DCF77">DCF77</a>-Antenne die aktuelle Uhrzeit, wie in einer Funkuhr. Mithilfe eines SD-Moduls wird auf einer SD-Karte eine Textdatei angelegt, in der die Wetterdaten gespeichert werden. Die Daten werden alle vier Sekunden aufgenommen und gespeichert, mit einer Zeile pro Datensatz. Dabei verwende ich das CSV-Format, sodass die Daten später einfach ausgewertet werden.</p>

<p>An die serielle Schnittstelle des Arduinos ist ein Bluetooth-Modul angeschlossen. Eine selbst entwickelte <a href="http://marian42.de/?p=179">Android-App</a> empfängt die Wetterdaten und zeigt sie an. Dazu werden die Daten in Textform über die serielle Verbindung gesendet, im Format Name-Doppelpunkt-Wert, also z.B. “Temperatur:25.41”. Neben den Wetterdaten werden in der App auch die Uhrzeit des DCF-Moduls und Informationen zur Stromversorgung angezeigt.</p>






<a href="/article/wetterstation/erkl%C3%A4rung.jpg" target="_blank" title="">
	<img src="/article/wetterstation/erkl%C3%A4rung_hu01afd7596af374f295ea80cb12fb1c7d_737220_1272x0_resize_q75_box.jpg" width="1272" alt="">
</a>



<p>Als Stromversorgung dient entweder ein Akku von einem Modellauto (7,2V, 3Ah), der auf dem Board auf 5V reguliert wird, oder ein Handyladegerät, das über den Micro-USB-Port an das ILC-Board angeschlossen wird. Die Widerstände auf dem Breadboard dienen dazu, zwischen dem Arduino mit 5V und dem ILC-Board (bzw. dem DCF77-Modul) mit 3,3V zu kommunizieren.</p>

<p>Der eine Knopf setzt den Arduino zurück und der andere schaltet das Bluetooth-Modul an oder aus. Die rote LED leuchtet auf, wenn ein Fehler auftritt, wie zum Beispiel ein fehlerhaftes Zeitsignal oder eine fehlende SD-Karte. Die rechte grüne LED leuchtet immer und die linke visualisiert das DCF-Signal, sodass man erkennen kann, ob die Antenne richtig ausgerichtet ist.</p>

<p><a href="/article/wetterstation/wetterstation.png" rel="lightbox[8]" title="Arduino-Wetterstation mit Bluetooth, Datalogging und Android-App"></p>






<img src="/article/wetterstation/wetterstation_o.png" width="1024" alt="">








<a href="/article/wetterstation/wetterstation.png" target="_blank" title="">
	<img src="/article/wetterstation/wetterstation_huf514aa3aa432b302687eb64190d36974_448406_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p></a></p>






<a href="/article/wetterstation/schaltplan.png" target="_blank" title="">
	<img src="/article/wetterstation/schaltplan_hu5dcb1ed7ddd03f83ffedb4c52c79eab9_274582_1272x0_resize_box_2.png" width="1272" alt="">
</a>



<p>Der Hauptnachteil von meinem Projekt ist, dass es nicht wetterfest ist und somit nicht ohne zusätzliches Gehäuse draußen aufgestellt werden kann. Die Wetterstation bringt den ATmega an seine Grenzen was <a href="http://www.atmel.com/Images/doc8161.pdf" target="_blank">Programm- und Arbeitsspeicher</a> betrifft. Für weitere Features wie eine aktive Steuerung über Bluetooth wäre also z.B. ein <a href="http://arduino.cc/de/Main/ArduinoBoardMega" target="_blank">Arduino Mega</a> notwendig. Ein weiteres Problem ist die Zuverlässigkeit des DCF77-Moduls, das drinnen oft kein Signal empfängt. In Zukunft plane ich, ein ähnliches Projekt mit einem <a href="http://de.wikipedia.org/wiki/Raspberry_Pi" target="_blank">Raspberry Pi</a> umzusetzen, der dann alle Aufgaben außer dem Sammeln der Sensordaten übernimmt. Die Daten könnten so über das Internet bereitgestellt werden und die Beschränkung durch die Bluetooth-Reichweite entfällt.</p>






<img src="/article/wetterstation/gui.png" width="1247" alt="">



<p>Ich habe mit dem Projekt bei der <a href="http://www.intel-leibniz-challenge.de/">Intel Leibniz Challenge 2013</a> teilgenommen, bin aber nicht in die Endauswahl gekommen. Für diesen Wettbewerb habe ich auch eine GUI entwickelt, mit der die Daten über eine USB-Verbindung am Computer angezeigt werdenkönnen.</p>

<p>Downloads: <a href="/article/wetterstation/Wetterstation.ino">Arduino-Sketch</a>, <a href="/article/wetterstation/Wetterstation_tiny.ino">Arduino-Sketch für den ATtiny</a>, <a href="http://marian42.de/?p=179">Android-App</a> (mindestens Android 4.0), <a href="/article/wetterstation/Wetterstation.fzz">Fritzing-Schaltplan</a>.</p>
    
</div>

    
<div class="footer">


	
	    
	        <div class="tags">
				tagged
	            <div class="links">
	                
	                    <a href="/tags/arduino">arduino</a>
	                
	                    <a href="/tags/bluetooth">bluetooth</a>
	                
	                    <a href="/tags/c&#43;&#43;">c&#43;&#43;</a>
	                
	                    <a href="/tags/de">de</a>
	                
	                    <a href="/tags/hardware">hardware</a>
	                
	            </div>
	        </div>
	    
	
</div>

</article>

    </div>
	
     

        </div>

        
<footer>
    <div class="container">
		<div class="left">
			
			
				<a href="mailto:mail@marian42.de">Contact</a>&nbsp;
			
        </div>
        <div class="right">
            
            <div class="external-profiles">
                
                    <a href="https://mastodon.gamedev.place/@marian42" target="_blank" rel="me">
                        <i class="fa">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                
                                <path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/>
                            </svg>
                        </i>
                    </a>
                
                
                    <a href="https://twitter.com/marian42_" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                    <a href="https://github.com/marian42" target="_blank"><i class="fa fa-github"></i></a>
                
				
                    <a href="mailto:mail@marian42.de" target="_blank"><i class="fa fa-envelope"></i></a>
                
				
                    <a href="/index.xml" target="_blank"><i class="fa fa-rss"></i></a>
                
            </div>
            
        </div>
    </div>
</footer>



        
    </body>
</html>
